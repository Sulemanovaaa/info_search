








OpenNews: Уязвимость в TP-Link SR20, позволяющая получить root-доступ из локальной сети

var topnews=[
{l:-2,n:50419,t:'В GTK 4 будет переработан бэкенд, отображающий интерфейс через web-браузер'},
{l:-1,n:50418,t:'Представлен Lucet, компилятор для WebAssembly'},
{l:0,n:50417,t:'Уязвимость в TP-Link SR20, позволяющая получить root-доступ из локальной сети'},
{l:1,n:50415,t:'Оценка типичных проблем с безопасностью для различных языков программирования'},
{l:2,n:50414,t:'Бета-выпуск Ubuntu 19.04'}
];


    
  var raw_nowtime=1554711804;











Профиль: Аноним (вход | регистрация)












НОВОСТИ (+)

КОНТЕНТ

WIKI

MAN'ы

ФОРУМ


Поиск (теги)




     



    .hdr_mobile {
	text-align: center; 
	display: none;
	margin: 0px;
	padding: 0px;
    }







[ новости /+++ | форум | wiki | теги
| 
]





















Уязвимость в TP-Link SR20, позволяющая получить root-доступ из локальной сети

29.03.2019 12:30




Мэтью Гаррет (Matthew Garrett), известный разработчик ядра Linux, в своё время получивший от Фонда СПО премию за вклад в развитие свободного ПО, обнаружил уязвимость в устройстве TP-Link SR20, сочетающем функции беспроводного маршрутизатора и шлюза для управления устройствами в умном доме (Zigbee/ZWave hub). Уязвимость позволяет получить полный контроль за устройством и выполнить на нём произвольные команды с правами root при наличии доступа к домашней локальной сети (например, в случае взлома одного из незащищённых IoT-устройств, атака может быть перенесена на маршрутизатор для полного контроля за локальной сетью).


Проблема связана с реализацией  протокола  
TDDP (TP-Link Device Debug Protocol), обработчик которого запускается по умолчанию. Первая версия протокола TDDP поддерживает выполнение запросов без аутентификации, но во второй версии для доступа требуется передача пароля пользователя admin. По умолчанию применяется вторая версия протокола, но оказалось, что поддержка первой версии сохранена и изменив один байт в заголовке пакета можно откатиться на версию, не требующую аутентификации.

Дальнейший разбор показал, что в составе пакета TDDP передаётся два строковых параметра - имя файла обработчика и имя файла конфигурации. При получении команды выполняется  функция  

tddp_execCmd("cd /tmp; tftp -gr %s %s &",luaFile,remote_address)
, которая запускает утилиту tftp для установки обратного соединения и загрузки указанного в параметрах файла-обработчика. После загрузки полученный файл передаётся в интерпретатор языка Lua, в котором выполняется типовая функция config_test() с указанием имени файла конфигурации и IP-адреса. 

Так как функция config_test() определена внутри загруженного с удалённой системы файла, атакующий может организовать выполнение любого Lua-кода в контексте устройства, в том числе при помощи метода os.execute() выполнить произвольные команды в системе. Обработчик TDDP  запускается с правами root и не сбрасывает привилегии, поэтому и код атакующего будет выполнен с правами root.

Информация о проблеме была передана в TP-Link ещё в декабре через специальную форму для информирования об уязвимостях, но компания никак не отреагировали на сообщение. После этого Гаррет попытался связаться с представителями TP-Link через Twitter, но также не получил ответа.











исправить  
+8 +/–





Главная ссылка к новости (https://mjg59.dreamwidth.org/5...)
OpenNews: Новые уязвимости в маршрутизаторах MikroTik и TP-Link
OpenNews: Удалённо эксплуатируемые уязвимости в маршрутизаторах TP-Link TL-R600VPN
OpenNews: TP-Link согласился вернуть поддержку альтернативных прошивок
OpenNews: 83% изученных беспроводных маршрутизаторов содержат неисправленные уязвимости
OpenNews: В "умной" лампочке выявлено нарушение GPL и серьёзные проблемы с безопасностью


Лицензия: CC-BY
Тип: Проблемы безопасности
Ключевые слова: tp-link
При перепечатке указание ссылки на opennet.ru обязательно




Обсуждение (38)
Ajax/Линейный | Раскрыть все сообщения |  
RSS




 

1.1, Аноним (1), 13:14, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору] 
+/–
Свой роутер можно декомплировать? Это не нарушение гарантии и лицензионного соглашения?
 

 
2.2, Нанобот (ok), 13:23, 29/03/2019 [^] [ответить]    [к модератору] 
–3 +/–
лицензионного соглашения на роутер???
 
 
3.8, Аноним (8), 14:39, 29/03/2019 [^] [ответить]    [к модератору] 
–1 +/–
Не знаю, как в данной модели, но к некоторым роутерам прикладывается листок с текстом GPL.
 

2.3, Аноним (-), 13:26, 29/03/2019 [^] [ответить]     [к модератору] +1 +/–Да, нарушение  Но когда это было серьезным препятствием  Мы случайно бэкдор  Это... весь текст скрыт [показать] 
2.10, Аноним84701 (ok), 14:54, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553853264,'Аноним84701')
+/–
> Свой роутер можно декомплировать?
Можно. Сим разрешаю!
>  Это не нарушение гарантии и лицензионного соглашения? 
Это зависит от конкретного законодательства конкретной страны. Законодательство обычно превалирует над лицензионными фантазиями в ЕУЛАх и реверсинг с целью обеспечения штатной работы или проверки безопасности нередко все же разрешен.

 
2.12, Аноним (12), 15:09, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553854190,'Аноним')
+/–
binwalk и Ghidra с IDA Pro запусти.
 
2.24, KonstantinB (??), 20:55, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553874903,'KonstantinB')
+1 +/–
Законодательство конкретной страны приоритетнее, чем текст EULA.
Конкретно в РФ:
1) декомпиляция разрешена ст. 1280 ГК РФ,
2) условия гарантии не могут противоречить Закону о защите прав потребителей.
 



1.4, Дегенератор (ok), 13:51, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553849482,'Дегенератор')
–1 +/–
Так в ПО или в устройстве?
 



1.5, Анонимс (?), 13:59, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553849952,'Анонимс')
+4 +/–
> информация о проблеме была передана в TP-Link ещё в декабре
> после этого Гаррет попытался связаться с представителями TP-Link через Twitter
> но компания никак не отреагировала на сообщение
TP-Link плевать на безопасность пользователей. Вот и всё, что нужно знать о компании, если вдруг кто-то решил приобрести их продукты. 
 

 
2.6, cherrypick (?), 14:15, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553850934,'cherrypick')
+5 +/–
Забавно. Компании, встраивающей бэкдоры в свои устройства плевать на безопасность пользователей. Вот это да!
 
2.9, Нанобот (ok), 14:41, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553852497,'Нанобот')
–1 +/–
>TP-Link плевать на безопасность пользователей
проблемы индейцев вождя не волнуют. у 90% компаний так. остальные 10% время от времени устраивают демонстративную клоунаду на тему "безопасность наших клиентов важна для нас" и хомячки ведутся
 
2.13, Аноним (13), 16:39, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553859597,'Аноним')
+4 +/–
>Вот и всё, что нужно знать о компании, если вдруг кто-то решил приобрести их продукты.
Но на многие её продукты можно залить OpenWRT.
 
 
3.15, НяшМяш (ok), 17:33, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553862781,'НяшМяш')
+4 +/–
Именно за это мы её и любим. Достаточно неплохие железки за малую цену + OpenWRT делают из тплинков конфетку.
 
 
4.29, Аноним (29), 21:33, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553877214,'Аноним')
+/–
Аппаратные бекдоры прошивкой не уберешь.
 
 
5.35, fske (?), 10:56, 30/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553925393,'fske')
+1 +/–
Список аппаратных бэкдоров тплинка в студию.
 



2.33, Онаним (?), 00:46, 30/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553888773,'Онаним')
+3 +/–
S in TP-Link is for Security.
 



1.7, iv (?), 14:32, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553851947,'iv')
–2 +/–
> После этого Гаррет попытался связаться с представителями TP-Link через Twitter, но также не получил ответа.
Мэтью известный троль, наверное tp-link просто не хотели кормить)
 

 
2.11, Аноним (11), 15:04, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553853886,'Аноним')
+/–
Ага, он, небось, написал, что разработчик ядра, и попросил у них исходники в соответствии с GPL. Вот они и притихли.
 
 
3.34, Аноним (34), 07:14, 30/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553912057,'Аноним')
+/–
Вы бы знали, что именно он написал, если бы интересовались первоисточниками, а не приходили сюда почитать местные пересказы и потрындеть.
 




1.14, YetAnotherOnanym (ok), 17:13, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553861590,'YetAnotherOnanym')
+/–
> Первая версия протокола TDDP поддерживает выполнение запросов без аутентификации, но во второй версии для доступа требуется передача пароля пользователя admin.
Ай, молодцы!
 



1.16, аноним еще один (?), 17:33, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553862789,'аноним еще один')
+1 +/–
А что Вы хотели от китайской компании тп линк. В Китае любят следить за всеми. все эти дыры задуманы изначально, поэтому и молчат. 
 

 
2.30, Аноним (29), 21:38, 29/03/2019 [^] [ответить]     [к модератору]  s_n_a(1553877488,'Аноним')–2 +/–То есть американская Cisco, индусско-американская M , дофига британских и америк... весь текст скрыт [показать] 



1.17, Аноним (17), 17:38, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553863082,'Аноним')
–2 +/–
Как-то это всё больше на рекламу роутера смахивает чем на реальную новость %{
 



1.18, Аноним (-), 17:41, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553863295,'Аноним')
+4 +/–
Админы локалхоста напряглись. :)
 

 
2.19, Аноним (17), 18:07, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553864827,'Аноним')
+/–
И что мне подсказывает что контингент использующий подобный металлолом практически никак не пересекается с теми кто в курсе подобных "новостей"?... Так что, думаю, напрягаться некому
 



1.20, Анкх (?), 18:44, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553867094,'Анкх')
–1 +/–
Посоветуйте роутер под заливку  openwrt с vlan ами под организацию dmz. (для дома).
Спасибо. 
 

 
2.27, Гентушник (ok), 21:19, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553876378,'Гентушник')
+/–
Смотри тут:
https://openwrt.org/toh/views/toh_available_864
 



1.21, Аноним (21), 19:23, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553869402,'Аноним')
+/–
АНБ же предупреждало: не покупайте китайские устройства и антивирус от одной известной компании. Но покупатели, как всегда, не послушались.
 

 
2.23, Аноним (23), 19:37, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553870248,'Аноним')
+1 +/–
Там тоже импортозамещение, зонты должны быть полосатыми.
 
2.37, Fedd (ok), 13:08, 31/03/2019 [^] [ответить]    [к модератору]  s_n_a(1554019683,'Fedd')
+/–
У АНБ свои интересы
 



1.25, Kuromi (ok), 21:00, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553875219,'Kuromi')
–1 +/–
Лол, уязвимость из локальной сети. 
Я приведу пример - Умные устройства TP-link совершенно открыто доступны кому угодны из локальной сети. Можно находить, менять настройки, включать выключать, считается что раз тебя пустили (не важно как) в сеть, значит ты свой. Не считаю это уязвимость, впрочем, решение - не пускать кого попало и использовать гостевые сети с изоляцией клиентов от основной.
 

 
2.26, Аноним (26), 21:13, 29/03/2019 [^] [ответить]     [к модератору]  s_n_a(1553875984,'Аноним')+/–При таком отношении взлом любого клиента в локальной сети автоматически приведёт... весь текст скрыт [показать] 
2.28, Аноним (29), 21:32, 29/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553877143,'Аноним')
+/–
>Не считаю это уязвимость
Конечно не уязвимость, это просто на чёрный ход замок не повесили.
 



1.31, AnonPlus (?), 22:17, 29/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553879868,'AnonPlus')
–1 +/–
Давайте напишем свой никому не известный протокол, что же может пойти не так?
 



1.32, Онаним (?), 00:44, 30/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1553888694,'Онаним')
–1 +/–
А ведь поветрие. Такое ощущение, что младший инженерно-разработчиковый состав деградировал ниже плинтуса везде.
 

 
2.36, incub (?), 17:26, 30/03/2019 [^] [ответить]    [к модератору]  s_n_a(1553948781,'incub')
+/–
Для это надо было сначала развится, что в заданно контексте небыло изначально.
 



1.38, Fedd (ok), 13:33, 31/03/2019  [ответить] [показать ветку] [···]    [к модератору]  s_n_a(1554021210,'Fedd')
+/–
А какие ещё есть аналоги с поддержкой Zigbee и Z-Wave?
 

 
2.39, АНБ (?), 10:38, 01/04/2019 [^] [ответить]    [к модератору]  s_n_a(1554097082,'АНБ')
+/–
тоже хочешь поискать эксплойтов?
 




var hidden_msg = new Array(0,3,30,26); 
var hidden_idx = new Array(0,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4); 
if (text_type == 1){ open_block(116953,3,hidden_msg,1);}




 Добавить комментарий











Имя:
E-Mail:
Заголовок:
Текст:






setup_nick();



load_topnews(1);












    var re = new RegExp('Android|Mobile|Opera Mini','');
    if (navigator.userAgent && re.exec(navigator.userAgent) == null){
	(adsbygoogle = window.adsbygoogle || []).push({});
    }




Навигация




     
Фильтры
    События
    Обзоры и статьи
    Программы
    Уязвимости
    Исключить Linux
    Исключить BSD
    ----- Формат вывода
    10 полных
    20 сокращенных
    40 заголовков
    


 Каналы:      
 Разделы новостей | Сводные
 Что нового на OpenNet
 Поиск в новостях
 Новые комментарии
 Добавить свою новость




Памятные даты


8 апреля RFC исполнилось 50 лет


load_topnews(2);


Важное


- 06.04 Новая криптографическая библиотека EverCrypt с математическим доказательством надёжности (86 +14)
- 04.04 Sisvel формирует патентный пул для сбора отчислений за использование кодеков AV1 и VP9 (169 –44)
- 28.03 Mozilla развивает WASI для использования WebAssembly вне браузера (114 +10)
- 13.03 Выпуск пользовательского окружения GNOME 3.32 (242 +27)
- 06.03 SPOILER - новая атака на механизм спекулятивного выполнения CPU Intel (199 +44)



Советы


- 03.04 Объединение томов через aufs для отказоустойчивости и моментального восстановления 
- 31.03 vmhgfs в старых CentOS и RHEL
- 30.03 Связывание повторяемых сборок GNU Guix с архивом исходных текстов  Software Heritage
- 14.03 Использование slackpkg для chroot
- 03.03 Как сделать пометку ошибок правописания в Firefox более заметной



Обсуждаемые новости


- 11:19 Новая версия музыкального проигрывателя DeaDBeeF 1.8.0  (47)
- 11:18 Сообщество Blender выпустило свободный анимационный фильм Sp (83)
- 11:06 В рамках проекта HermiTux развивается unikernel, бинарно сов (72)
- 10:58 В Wine Staging добавлены патчи для повышения производительно (14)
- 10:34 В Ruby-библитеке bootstrap-sass выявлен бэкдор (32)
- 10:32 Выпуск проекта DXVK 1.1 с реализацией Direct3D 10/11 поверх  (27)
- 10:02 Дерек Форман ушёл поста ответственного за выпуск релизов Way (65)
- 09:59 Релиз дистрибутива для исследования безопасности систем Kali (26)
























  Закладки на сайте
  Проследить за страницей



Created 1996-2019 by Maxim Chirkov  
Добавить, Поддержать, Вебмастеру, ГИД  











  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-123449-1', 'auto');
    ga('send', 'pageview');





